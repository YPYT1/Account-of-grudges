<view class="container">
  <!-- é¡¶éƒ¨æƒ…ä¾£ä¿¡æ¯åŒºåŸŸ -->
  <view class="couple-header">
    <view class="couple-avatars">
      <view class="avatar-container left">
        <i-avatar 
          src="{{userInfo.currentUser.avatar_url}}" 
          size="large" 
          shape="circle"
        />
        <text class="nickname">{{userInfo.currentUser.nickname}}</text>
      </view>
      
      <view class="love-progress">
        <text class="progress-value">{{loveProgress}}%</text>
        <view class="progress-container">
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{loveProgress}}%"></view>
          </view>
        </view>
      </view>
      
      <view class="avatar-container right">
        <i-avatar 
          src="{{userInfo.partner.avatar_url}}" 
          size="large" 
          shape="circle"
        />
        <text class="nickname">{{userInfo.partner.nickname}}</text>
      </view>
    </view>
  </view>

  <!-- äº‹ä»¶ç±»å‹åˆ‡æ¢æŒ‰é’® -->
  <view class="event-type-tabs">
    <view 
      class="event-type-tab {{currentEventType === 'sweet_moment' ? 'active' : ''}}" 
      data-type="sweet_moment" 
      bindtap="onEventTypeChange"
    >
      ç”œèœœæ—¶åˆ»
    </view>
    <view 
      class="event-type-tab {{currentEventType === 'brainstorming' ? 'active' : ''}}" 
      data-type="brainstorming" 
      bindtap="onEventTypeChange"
    >
      é£æš´æ—¶åˆ»
    </view>
  </view>

  <!-- äº‹ä»¶åˆ—è¡¨ -->
  <view class="event-list">
    <view 
      class="event-item card-shadow" 
      wx:for="{{eventList}}" 
      wx:key="id"
    >
      <view class="event-header">
        <view class="author-info">
          <text class="author-name">{{item.author.nickname}}</text>
          <text class="event-date">{{item.event_date}}</text>
        </view>
        <view class="mood-tag">
          <text class="mood-emoji">{{item.mood_tag.emoji}}</text>
          <text class="mood-name">{{item.mood_tag.name}}</text>
        </view>
      </view>
      
      <view class="event-content">
        <text class="event-description">{{item.description}}</text>
        <view class="event-location" wx:if="{{item.location_text}}">
          <text class="location-icon">ğŸ“</text>
          <text class="location-text">{{item.location_text}}</text>
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{eventList.length === 0}}">
      <text class="empty-text">è¿˜æ²¡æœ‰è®°å½•ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹è®°å½•å§ï½</text>
    </view>
  </view>

  <!-- æ‚¬æµ®æ·»åŠ æŒ‰é’® -->
  <view class="fab-button" bindtap="showAddForm">
    <text class="fab-icon">+</text>
  </view>

  <!-- æ·»åŠ è¡¨å•å¼¹çª— -->
  <view class="modal-overlay {{showAddForm ? 'show' : ''}}" bindtap="hideAddForm">
    <view class="modal-content" catchtap="preventDefault">
      <view class="modal-header">
        <text class="modal-title">æ·»åŠ æ–°è®°å½•</text>
        <view class="modal-close" bindtap="hideAddForm">Ã—</view>
      </view>
      
      <view class="form-container">
        <!-- äº‹ä»¶ç±»å‹é€‰æ‹© -->
        <view class="form-section">
          <view class="section-title">äº‹ä»¶ç±»å‹</view>
          <view class="type-selector">
            <view 
              class="type-option {{formData.type === 'sweet_moment' ? 'selected' : ''}}"
              data-type="sweet_moment"
              bindtap="onEventTypeChange"
            >
              ğŸ’• ç”œèœœæ—¶åˆ»
            </view>
            <view 
              class="type-option {{formData.type === 'brainstorming' ? 'selected' : ''}}"
              data-type="brainstorming"
              bindtap="onEventTypeChange"
            >
              ğŸ§  é£æš´æ—¶åˆ»
            </view>
          </view>
        </view>

        <!-- äº‹ä»¶æè¿° -->
        <view class="form-section">
          <view class="section-title">äº‹ä»¶æè¿°</view>
          <textarea 
            class="description-input" 
            placeholder="æè¿°ä¸€ä¸‹å‘ç”Ÿäº†ä»€ä¹ˆ..."
            value="{{formData.description}}"
            bindinput="onDescriptionInput"
            maxlength="200"
          ></textarea>
        </view>

        <!-- å¿ƒæƒ…é€‰æ‹© -->
        <view class="form-section">
          <view class="section-title">é€‰æ‹©å¿ƒæƒ…</view>
          <view class="mood-tags">
            <view 
              class="mood-tag-item {{formData.mood_tag_id === item.id ? 'selected' : ''}}"
              wx:for="{{moodTags}}" 
              wx:key="id"
              data-id="{{item.id}}"
              bindtap="onMoodTagSelect"
            >
              <text class="tag-emoji">{{item.emoji}}</text>
              <text class="tag-name">{{item.name}}</text>
            </view>
          </view>
        </view>

        <!-- æ—¥æœŸé€‰æ‹© -->
        <view class="form-section">
          <view class="section-title">å‘ç”Ÿæ—¥æœŸ</view>
          <picker 
            mode="date" 
            value="{{formData.event_date}}" 
            bindchange="onDateChange"
          >
            <view class="date-picker">
              {{formData.event_date || 'é€‰æ‹©æ—¥æœŸ'}}
            </view>
          </picker>
        </view>

        <!-- åœ°ç‚¹è¾“å…¥ -->
        <view class="form-section">
          <view class="section-title">åœ°ç‚¹ï¼ˆå¯é€‰ï¼‰</view>
          <input 
            class="location-input" 
            placeholder="åœ¨å“ªé‡Œå‘ç”Ÿçš„å‘¢ï¼Ÿ"
            value="{{formData.location_text}}"
            bindinput="onLocationInput"
          />
        </view>
      </view>

      <!-- è¡¨å•æŒ‰é’® -->
      <view class="form-actions">
        <view class="action-button cancel" bindtap="hideAddForm">å–æ¶ˆ</view>
        <view class="action-button submit" bindtap="onSubmitForm">æäº¤</view>
      </view>
    </view>
  </view>
</view> 